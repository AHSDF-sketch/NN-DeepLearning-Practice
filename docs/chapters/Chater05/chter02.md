# 第05章：线性模型 - 第2部分
## 5.2 线性回归求解
### 核心内容：单变量回归、多元回归与求解关键  
| 知识点         | 具体内容                                                                 | 
|----------------|--------------------------------------------------------------------------|
| 单变量线性回归目标 | 核心是最小化**均方误差（MSE）**，均方误差用来衡量预测值与真实值的平均平方差距，公式为：<br>$MSE = \frac{1}{n}\sum_{i=1}^n (y_i - (wx + b))^2$<br>其中，<br>$y_i$<br>是第i个样本的真实值，<br>$wx + b$<br>是预测值，n是样本总数，w是直线斜率（属性权重），b是直线截距（偏置） |
| 单变量闭式解   | 通过“让均方误差分别对w和<b的偏导数等于0”求解最优参数，最终得到：<br>$\hat{w} = \frac{\sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})}{\sum_{i=1}^n (x_i - \bar{x})^2}$<br> <br>$\hat{b} = \bar{y} - \hat{w}\bar{x}$<br>其中，<br>$\bar{x}$<br>是所有x的平均值，<br>$\bar{y}$<br>是所有y的平均值 |
| 多元线性回归模型 | 当输入是多属性向量（比如“面积、房间数、楼层”）时，模型公式为：<br>$f(x_i) = w^T x_i + b$<br>其中，<br>$x_i = (x_{i1}, x_{i2}, ..., x_{id})$<br>是第<br>$i$<br>个样本的<br>$d$<br>维属性向量，w是d维权重向量；为了简化计算，把b融入w（扩展为d+1>维），模型变成：<br>$f(x_i) = \hat{w}^T \hat{x}_i$<br>其中，<br>$\hat{x}_i = (x_i, 1)$<br>（在属性向量后加1）<br>$\hat{w} = (w, b)$<br>（在权重向量后加偏置b） | 
| 多元求解关键   | 1. 目标：最小化矩阵形式的均方误差：<br>$MSE = \frac{1}{n}\|Y - X\hat{w}\|^2$<br>其中，Y是n维真实值向量，X是<br>$n×(d+1)$<br>输入矩阵；<br>2. 最优解：当<br>$X^T X$<br>满秩或正定时，<br>$\hat{w} = (X^T X)^{-1} X^T Y$<br>（<br>$X^T$<br>是X的转置，<br>$(X^T X)^{-1}$<br>是<br>$X^T X$<br>的逆矩阵）；<br>3. 若<br>$X^T X$<br>不满秩（比如属性冗余）：可以引入正则化（如L2正则），或根据归纳偏好选择参数 |

### ➡️ 跳转至下一部分  
掌握线性回归求解后，点击学习线性模型的扩展（从回归到分类）：  
**[第05章：线性模型 - 第3部分](chter03.md)**
